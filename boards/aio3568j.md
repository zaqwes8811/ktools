# Links

1. Base info

https://en.t-firefly.com/product/industry/aio3568j


2. Download firefly image
download page

https://en.t-firefly.com/doc/download/index/id/91

download Ubuntu image (Firmware section)

go to google drive and download 

Ubuntu22.04/kernel-5.1/AIO-3568J-IPC_Ubuntu22.04-Xfce-r31127_v1.4.0d_251124.7z

```
sudo apt install p7zip


mv ~/Downloads/AIO-3568J-IPC_Ubuntu22.04-Xfce-r31127_v1.4.0d_251124.7z .

7z x AIO-3568J-IPC_Ubuntu22.04-Xfce-r31127_v1.4.0d_251124.7z

# Will create
# AIO-3568J-IPC_Ubuntu22.04-Xfce-r31127_v1.4.0d_251124/AIO-3568J-IPC_Ubuntu22.04-Xfce-r31127_v1.4.0d_251124.img
# And burn it to flash, image size around 3Gb

sudo apt install pv

insert sd card in reader

df -h

see it, it shows partition

/dev/mmcblk0p1  3,4G  3,1G  330M  91% /media/zaqwes/4GB

unmount it

sudo umount /media/zaqwes/4GB

we need /dev/mmcblk0

DOUBLE CHECK!!! Error may be fatal for host system

pv AIO-3568J-IPC_Ubuntu22.04-Xfce-r31127_v1.4.0d_251124/AIO-3568J-IPC_Ubuntu22.04-Xfce-r31127_v1.4.0d_251124.img | sudo dd of=/dev/mmcblk0 bs=4M conv=fsync


sudo dd if=AIO-3568J-IPC_Ubuntu22.04-Xfce-r31127_v1.4.0d_251124/AIO-3568J-IPC_Ubuntu22.04-Xfce-r31127_v1.4.0d_251124.img of=/dev/mmcblk0 status=progress bs=4M conv=fsync

```

3. Burn image to sd card

4. Docs

https://wiki.t-firefly.com/en/Core-3568J/preface.html


# Build stock code

1. pull code

https://wiki.t-firefly.com/en/Core-3568J/linux_compile_linux5.10.html#build-the-build-environment

```
cd boards
mkdir rk356x_sdk-linux5.10 && cd rk356x_sdk-linux5.10

## Full SDK
repo init --no-clone-bundle --repo-url https://github.com/Firefly-rk-linux-utils/git-repo.git --no-repo-verify -u https://github.com/Firefly-rk-linux/manifests.git -b master -m rk356x_linux5.10_release.xml

.repo/repo/repo sync -c --no-tags
.repo/repo/repo start firefly --all

./build.sh firefly_rk3568_aio-3568j_ubuntu_defconfig

# prebuilt rootfs
PREBUILT_ROOTFS_IMG="prebuilt_rootfs/rk356x_ubuntu_rootfs.img"
# UART for bluetooth
RK_WIFIBT_TTY="ttyS8"
# kernel defconfig
RK_KERNEL_CFG="firefly_linux_defconfig"
# device tree name
RK_KERNEL_DTS_NAME="firefly-rk3568-aioj"  << Need it
# ramdisk image
RK_RAMDISK_IMG="ramdisk.img"
# image tree source for boot partition image
RK_BOOT_FIT_ITS="bootramdisk.its"
# prebuilt recovery image
RK_RECOVERY_RAMDISK="rk356x-recovery-arm64.cpio.gz"
# parameter
RK_PARAMETER="parameter-ubuntu-fit.txt"
# use FIT image
RK_USE_FIT_IMG=y
# use extlinux way to load kernel
USE_EXTBOOT=y

sudo apt-get install make gcc libssl-dev liblz4-tool \
    expect g++ patchelf chrpath gawk texinfo chrpath diffstat binfmt-support \
    qemu-user-static live-build bison flex fakeroot cmake \
    unzip device-tree-compiler python3-pip libncurses-dev python3-pyelftools

sudo apt-get install libgmp-dev
sudo apt-get install libmpc-dev

./build.sh uboot
./build.sh extboot

dts: ./kernel/arch/arm64/boot/dts/rockchip/rk3568-firefly-aioj.dts

cat rk356x_sdk-linux5.10/output/defconfig | grep DT
RK_KERNEL_DTS_NAME="rk3568-firefly-aioj"

kernel/arch/arm64/boot/dts/rockchip/rk3568-firefly-aioj.dtb



```